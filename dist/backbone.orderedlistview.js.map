{"version":3,"sources":["../backbone.orderedlistview.js"],"names":[],"mappings":"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","file":"backbone.orderedlistview.js","sourcesContent":["/*!\n * Backbone.OrderedListView\n *\n * Copyright (c) 2017, JC Brand <jc@opkode.com>\n * Licensed under the Mozilla Public License (MPL) \n */\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        define([\"underscore\", \"backbone\", \"backbone.overview\"], factory);\n   } else {\n      // RequireJS isn't being used.\n      // Assume underscore and backbone are loaded in <script> tags\n        factory(_ || root._, Backbone || root.Backbone);\n   }\n}(this, function (_, Backbone) {\n    \"use strict\";\n\n    Backbone.OrderedListView = Backbone.Overview.extend({\n        /* An OrderedListView is a special type of Overview which adds some\n         * methods and conventions for rendering an ordered list of elements.\n         */\n\n        // The `listItems` attribute denotes the path (from this View) to the\n        // list of items.\n        listItems: 'model',\n        // The `sortEvent` attribute specifies the event which should cause the\n        // ordered list to be sorted.\n        sortEvent: 'change',\n        // The `listSelector` is the selector used to query for the DOM list\n        // element which contains the ordered items.\n        listSelector: '.ordered-items',\n        // The `itemView` is constructor which should be called to create a\n        // View for a new item.\n        ItemView: undefined,\n        // The `subviewIndex` is the attribute of the list element model which\n        // acts as the index of the subview in the overview.\n        // An overview is a \"Collection\" of views, and they can be retrieved\n        // via an index. By default this is the 'id' attribute, but it could be\n        // set to something else.\n        subviewIndex: 'id',\n\n        initialize () {\n            this.sortEventually = _.debounce(\n                this.sortAndPositionAllItems.bind(this), 500);\n\n            this.items = _.get(this, this.listItems);\n            this.items.on('add', this.sortAndPositionAllItems, this);\n            this.items.on('remove', this.removeView, this);\n            if (!_.isNil(this.sortEvent)) {\n                this.items.on(this.sortEvent, this.sortEventually, this);\n            }\n        },\n\n        createItemView (item) {\n            let item_view = this.get(item.get(this.subviewIndex));\n            if (!item_view) {\n                item_view = new this.ItemView({model: item});\n                this.add(item.get(this.subviewIndex), item_view);\n            } else {\n                item_view.model = item;\n                item_view.initialize();\n            }\n            item_view.render();\n            return item_view;\n        },\n\n        removeView (item) {\n            this.remove(item.get(this.subviewIndex));\n        },\n\n        sortAndPositionAllItems () {\n            if (!this.items.length) {\n                return;\n            }\n            this.items.sort();\n\n            const list_el = this.el.querySelector(this.listSelector);\n            const div = document.createElement('div');\n            list_el.parentNode.replaceChild(div, list_el);\n            this.items.each((item) => {\n                let view = this.get(item.get(this.subviewIndex));\n                if (_.isUndefined(view)) {\n                    view = this.createItemView(item)\n                }\n                list_el.insertAdjacentElement('beforeend', view.el);\n            });\n            div.parentNode.replaceChild(list_el, div);\n        }\n    });\n\n    return Backbone.OrderedListView;\n}));\n"]}